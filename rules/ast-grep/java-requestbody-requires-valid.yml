# [TY1] @RequestBody must have @Valid for input validation
# External JSON payloads must be validated before entering domain logic.
# Spring Boot validates request bodies only when @Valid is present.

id: java-requestbody-requires-valid
language: java
severity: warning
message: "[TY1] @RequestBody without @Valid. Fix: add @Valid annotation for input validation"

rule:
  pattern: '@RequestBody $TYPE $VAR'
  not:
    any:
      - inside:
          pattern: '@Valid @RequestBody $TYPE $VAR'
      - inside:
          pattern: '@RequestBody @Valid $TYPE $VAR'

files:
  - "src/main/java/**/controller/**/*.java"
  - "src/main/java/**/web/**/*.java"

ignores:
  - "**/generated/**"
