<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Java Chat</title>
  <meta name="description" content="Beautiful AI-powered Java learning with cosmic coffee vibes and developer-first design">
  <meta name="keywords" content="Java, AI, learning, programming, coffee, solar, developer">
  <meta name="author" content="Java Chat">
  <meta name="theme-color" content="#0a0a0a">
  
  <!-- Developer Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png" />
  <link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196" />
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="/favicon-128.png" sizes="128x128" />
  <link rel="icon" href="/favicon.ico" />
  <meta name="application-name" content="Java Chat"/>
  <meta name="msapplication-TileColor" content="#FFFFFF" />
  <meta name="msapplication-TileImage" content="/mstile-144x144.png" />
  <meta name="msapplication-square70x70logo" content="/mstile-70x70.png" />
  <meta name="msapplication-square150x150logo" content="/mstile-150x150.png" />
  <meta name="msapplication-wide310x150logo" content="/mstile-310x150.png" />
  <meta name="msapplication-square310x310logo" content="/mstile-310x310.png" />
  <style>
     :root {
       /* SOLAR STARTUP 2025 - Premium Theme */
       /* Solar Primary Palette */
       --solar-orange: #ff6b35;
       --solar-amber: #ff8c42;
       --solar-gold: #ffa947;
       --solar-sunset: #ff5722;
       --solar-flame: #ff3d00;
       --solar-coral: #ff6e40;
       --solar-peach: #ffab91;
       --solar-cream: #fff3e0;
       
       /* Java Coffee Accents */
       --java-espresso: #3e2723;
       --java-mocha: #5d4037;
       --java-latte: #8d6e63;
       --java-cappuccino: #a1887f;
       --java-cream: #d7ccc8;
       
       /* Dark Mode Premium */
       --premium-black: #0a0908;
       --premium-charcoal: #121110;
       --premium-slate: #1a1816;
       --premium-graphite: #242220;
       --premium-ash: #2e2b28;
       
       /* ShadCN Base Colors */
       --shadcn-background: var(--premium-black);
       --shadcn-foreground: #fafaf9;
       --shadcn-card: var(--premium-charcoal);
       --shadcn-card-foreground: #fafaf9;
       --shadcn-popover: var(--premium-slate);
       --shadcn-popover-foreground: #fafaf9;
       --shadcn-primary: var(--solar-orange);
       --shadcn-primary-foreground: #ffffff;
       --shadcn-secondary: var(--premium-graphite);
       --shadcn-secondary-foreground: #fafaf9;
       --shadcn-muted: var(--premium-ash);
       --shadcn-muted-foreground: #a8a29e;
       --shadcn-accent: var(--solar-amber);
       --shadcn-accent-foreground: #ffffff;
       --shadcn-destructive: #ef4444;
       --shadcn-destructive-foreground: #fafafa;
       --shadcn-border: rgba(255, 107, 53, 0.15);
       --shadcn-input: rgba(255, 107, 53, 0.1);
       --shadcn-ring: var(--solar-orange);
       
       /* Legacy Coffee Variables (for compatibility) */
       --coffee-subtle: var(--java-mocha);
       --coffee-warm: var(--solar-amber);
       --coffee-cream: var(--solar-gold);
       --coffee-dark: var(--java-espresso);
       --coffee-light: var(--solar-cream);
       
       /* Dark Mode Premium Surfaces */
       --dark-bg: var(--premium-black);
       --dark-surface-1: var(--premium-charcoal);
       --dark-surface-2: var(--premium-slate);
       --dark-surface-3: var(--premium-graphite);
       --dark-border: rgba(255, 107, 53, 0.12);
       --dark-text-primary: #fafaf9;
       --dark-text-secondary: #d4d4d3;
       --dark-text-tertiary: #a8a29e;
       
       /* Theme Accents */
       --accent-primary: var(--solar-orange);
       --accent-secondary: var(--solar-amber);
       --accent-tertiary: var(--solar-gold);
       --dark-bg: var(--dark-bg);
       --dark-surface-1: var(--dark-surface-1);
       --dark-surface-2: var(--dark-surface-2);
       --dark-surface-3: var(--dark-surface-3);
       --dark-border: var(--dark-border);
       --dark-text-primary: var(--dark-text-primary);
       --dark-text-secondary: var(--dark-text-secondary);
       --dark-text-tertiary: var(--dark-text-tertiary);
       
       /* ShadCN Typography */
       --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
       --font-mono: 'JetBrains Mono', 'Fira Code', ui-monospace, SFMono-Regular, monospace;
       
       /* Premium Effects */
       --glow-orange: 0 0 20px rgba(255, 107, 53, 0.3);
       --glow-amber: 0 0 20px rgba(255, 140, 66, 0.25);
       --glow-subtle: 0 1px 3px rgba(0,0,0,0.12);
       --glow-soft: 0 4px 12px rgba(0,0,0,0.1);
       --shadow-subtle: 0 1px 2px rgba(0,0,0,0.05);
       --shadow-soft: 0 10px 25px rgba(0,0,0,0.15);
       --shadow-premium: 0 20px 40px rgba(0,0,0,0.2);
       
       /* Premium Gradients */
       --gradient-solar: linear-gradient(135deg, var(--solar-orange) 0%, var(--solar-amber) 100%);
       --gradient-sunset: linear-gradient(135deg, var(--solar-sunset) 0%, var(--solar-gold) 100%);
       --gradient-java: linear-gradient(135deg, var(--java-mocha) 0%, var(--java-latte) 100%);
       --gradient-premium: linear-gradient(135deg, var(--premium-slate) 0%, var(--premium-graphite) 100%);
       
       --radius-xs: 4px;
       --radius-sm: 6px;
       --radius-md: 10px;
       --radius-lg: 16px;
       --radius-xl: 24px;
       --radius-full: 9999px;
       --space-1: 0.25rem;
       --space-2: 0.5rem;
       --space-3: 0.75rem;
       --space-4: 1rem;
       --space-5: 1.25rem;
       --space-6: 1.5rem;
       --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
       --transition-smooth: 250ms cubic-bezier(0.4, 0, 0.2, 1);
       --transition-spring: 500ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
     }

    html, body { height: 100%; }
    body { margin: 0; background: var(--dark-bg); color: var(--dark-text-primary); font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
    .wrap { display: flex; flex-direction: column; height: 100vh; }

    /* Premium Navigation Bar */
    .tabs { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      padding: var(--space-4) var(--space-6); 
      background: linear-gradient(180deg, var(--premium-charcoal) 0%, var(--premium-slate) 100%);
      border-bottom: 1px solid var(--dark-border);
      position: sticky; 
      top: 0; 
      z-index: 100;
      -webkit-backdrop-filter: blur(20px);
      backdrop-filter: blur(20px);
      box-shadow: 0 1px 0 rgba(255, 107, 53, 0.05);
    }
    .tabs-left { 
      display: flex; 
      align-items: center; 
      gap: var(--space-6);
    }
    .tab-buttons { 
      display: flex; 
      gap: var(--space-1);
      padding: 3px;
      background: rgba(255, 107, 53, 0.05);
      border: 1px solid rgba(255, 107, 53, 0.1);
      border-radius: var(--radius-lg);
      position: relative;
    }
    .tab-buttons::before {
      content: '';
      position: absolute;
      inset: -1px;
      border-radius: var(--radius-lg);
      padding: 1px;
      background: linear-gradient(135deg, var(--solar-orange), var(--solar-amber));
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity: 0;
      transition: opacity var(--transition-smooth);
    }
    .tab-buttons:hover::before {
      opacity: 0.5;
    }
    .tabs-right { 
      display: flex; 
      gap: var(--space-3); 
      align-items: center;
    }
    
    /* Mobile Toolbar Styles */
    @media (max-width: 768px) {
      .tabs {
        padding: var(--space-2) var(--space-3);
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
      
      .tabs-left {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
      }
      
      .app-title {
        font-size: 1.1rem;
        flex-shrink: 0;
      }
      
      .tab-buttons {
        display: flex;
        gap: 8px;
        flex-shrink: 0;
      }
      
      .tab {
        padding: 8px 16px;
        font-size: 0.875rem;
        white-space: nowrap;
      }
      .tab .tab-label { max-width: 22vw; }
      .tab-label-long { display: inline; }
      .tab-label-short { display: none; }
      
      .tabs-right {
        display: none;
      }
    }
    
    /* Very narrow phones */
    @media (max-width: 420px) {
      .tab { padding: 6px 12px; font-size: 0.84rem; }
      .tab-buttons { gap: 6px; }
      .tab .tab-label { max-width: 26vw; }
      .tab-label-long { display: none; }
      .tab-label-short { display: inline; }
    }
     .app-title-link { 
       text-decoration: none; 
       display: inline-flex; 
       align-items: center;
       gap: var(--space-3);
       transition: all var(--transition-smooth); 
       position: relative;
       padding: var(--space-2) var(--space-3);
       border-radius: var(--radius-md);
       background: transparent;
     }
     .app-title-link:hover {
       background: rgba(255, 107, 53, 0.05);
     }
     .coffee-cup {
       width: 28px;
       height: 28px;
       position: relative;
       transition: all var(--transition-smooth);
       display: flex;
       align-items: center;
       justify-content: center;
       background: var(--gradient-solar);
       border-radius: var(--radius-sm);
       box-shadow: var(--shadow-subtle);
     }
     .coffee-cup::before {
       content: 'â˜•';
       font-size: 18px;
       filter: grayscale(1) brightness(10);
       transition: all var(--transition-smooth);
     }
     .app-title-link:hover .coffee-cup {
       transform: rotate(-5deg) scale(1.05);
       box-shadow: var(--glow-orange);
     }
     .app-title { 
       font-size: 1.25rem; 
       font-weight: 700; 
       background: linear-gradient(135deg, var(--solar-orange) 0%, var(--solar-gold) 100%);
       -webkit-background-clip: text;
       -webkit-text-fill-color: transparent;
       background-clip: text;
       margin: 0; 
       font-family: var(--font-sans);
       letter-spacing: -0.025em;
       transition: all var(--transition-smooth);
     }
     .app-title-link:hover .app-title {
       filter: brightness(1.1);
     }
     .tab { 
       appearance: none; 
       border: none;
       background: transparent;
       color: rgba(250, 250, 249, 0.7); 
       padding: var(--space-2) var(--space-4); 
       border-radius: var(--radius-md); 
       cursor: pointer; 
       transition: all var(--transition-smooth); 
       font-weight: 500; 
       font-size: 0.9rem;
       position: relative; 
       overflow: hidden;
       letter-spacing: 0.01em;
       display: flex;
       align-items: center;
       gap: var(--space-2);
       font-family: var(--font-sans);
     }
     .tab .tab-label { display:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width: 18ch; }
     .tab-label-short { display:none; }
     .tab::before {
       content: '';
       position: absolute;
       inset: 0;
       background: rgba(255, 107, 53, 0.05);
       border-radius: var(--radius-md);
       opacity: 0;
       transition: opacity var(--transition-fast);
     }
     .tab:hover { 
       color: rgba(250, 250, 249, 0.95);
     }
     .tab:hover::before {
       opacity: 1;
     }
     .tab[aria-selected="true"] { 
       background: var(--gradient-solar);
       color: white;
       font-weight: 600;
       box-shadow: 0 0 0 1px rgba(255, 107, 53, 0.2), var(--glow-orange);
       transform: scale(1.02);
     }
     .tab[aria-selected="true"]::after { 
       content: ''; 
       position: absolute; 
       inset: 0;
       border-radius: var(--radius-md);
       background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.2) 50%, transparent 70%); 
       animation: shimmer-premium 3s ease-in-out infinite; 
     }
     @keyframes shimmer-premium {
       0% { transform: translateX(-100%); opacity: 0; }
       50% { opacity: 1; }
       100% { transform: translateX(100%); opacity: 0; }
     }

    /* Panel */
    .panel { flex: 1; position: relative; }
    .frame { position: absolute; inset: 0; width: 100%; height: 100%; border: none; background: var(--dark-surface-1); }

    /* Basic a11y focus */
    .tab:focus { outline: 2px solid var(--accent-primary); outline-offset: 2px; }

     .tab-icon {
       font-size: 16px;
       transition: all var(--transition-smooth);
       filter: grayscale(0.5);
     }
     .tab:hover .tab-icon {
       filter: grayscale(0);
       transform: rotate(-5deg) scale(1.1);
     }
     .tab[aria-selected="true"] .tab-icon {
       filter: grayscale(0) brightness(1.2);
       animation: icon-glow 2s ease-in-out infinite;
     }
     @keyframes icon-glow {
       0%, 100% { transform: scale(1); }
       50% { transform: scale(1.1); }
     }

     /* Premium Info Badges - Distinct from Navigation */
     .info-badge { 
       display: inline-flex; 
       align-items: center; 
       gap: var(--space-2); 
       padding: var(--space-1) var(--space-3); 
       background: rgba(255, 107, 53, 0.08);
       border: 1px solid rgba(255, 107, 53, 0.15);
       border-radius: var(--radius-full); 
       font-size: 0.8rem; 
       color: var(--solar-peach); 
       cursor: default;
       font-weight: 500;
       font-family: var(--font-mono);
       letter-spacing: 0.02em;
       -webkit-backdrop-filter: blur(10px);
       backdrop-filter: blur(10px);
       transition: all var(--transition-smooth);
       position: relative;
       overflow: hidden;
     }
     .info-badge::before {
       content: '';
       position: absolute;
       inset: 0;
       background: linear-gradient(135deg, transparent, rgba(255, 107, 53, 0.1), transparent);
       transform: translateX(-100%);
       transition: transform 1s ease;
     }
     .info-badge:hover::before { 
       transform: translateX(100%);
     }
     .info-badge:hover {
       background: rgba(255, 107, 53, 0.12);
       border-color: rgba(255, 107, 53, 0.25);
       transform: translateY(-1px);
     }
     .status-indicator {
       width: 6px;
       height: 6px;
       border-radius: 50%;
       background: var(--solar-gold);
       box-shadow: 0 0 8px var(--solar-gold);
       animation: pulse-glow 2s ease-in-out infinite;
     }
     @keyframes pulse-glow {
       0%, 100% { opacity: 0.6; box-shadow: 0 0 4px var(--solar-gold); }
       50% { opacity: 1; box-shadow: 0 0 12px var(--solar-gold); }
     }
    .pill-with-badge { 
      position: relative; 
      padding-right: 32px;
      overflow: visible;
    }
     .new-badge { 
       position: absolute; 
       top: -5px; 
       right: 2px; 
       background: var(--gradient-sunset);
       color: white; 
       font-size: 0.55rem; 
       font-weight: 700; 
       padding: 2px 5px; 
       border-radius: var(--radius-full); 
       line-height: 1; 
       box-shadow: 0 2px 6px rgba(255, 107, 53, 0.4);
       animation: badge-pulse 2s ease-in-out infinite;
       border: 1px solid rgba(255, 255, 255, 0.2);
       text-transform: uppercase;
       letter-spacing: 0.04em;
       min-width: 18px;
       text-align: center;
       z-index: 10;
     }
     @keyframes badge-pulse {
       0%, 100% { transform: scale(1) rotate(0deg); }
       50% { transform: scale(1.05) rotate(2deg); }
     }
     @keyframes subtle-pulse {
       0%, 100% { opacity: 0.9; }
       50% { opacity: 1; }
     }
    @keyframes badge-pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

    /* Loader overlay - FIXED to prevent overlapping */
    .loader-overlay { 
      position:absolute; 
      inset:0; 
      display:none; 
      align-items:center; 
      justify-content:center; 
      background: var(--dark-bg); /* Solid background to prevent see-through */
      z-index: 1000; /* Ensure it's on top */
      opacity: 0;
      transition: opacity 200ms ease;
    }
    .loader-overlay.show { 
      display:flex; 
      opacity: 1;
    }
    .loader {
      display: grid; gap: 10px; width: min(600px, 80%);
    }
    .shimmer { position: relative; overflow: hidden; background: #1a1d23; border:1px solid var(--dark-border); border-radius: 10px; }
    .shimmer::before { content:""; position:absolute; inset:0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.06), transparent); transform: translateX(-100%); animation: shimmer 1.6s infinite; }
    @keyframes shimmer { 0% { transform: translateX(-100%);} 100% { transform: translateX(100%);} }
    .shimmer.small { height: 12px; }
    .shimmer.medium { height: 16px; }
    .shimmer.large { height: 42px; }
    .row-2 { height: 72px; }
    .rounded { border-radius: 9999px; }
    .pad { padding: 14px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="tabs">
       <div class="tabs-left">
         <a href="/" class="app-title-link" aria-label="Java Chat - Home">
           <div class="coffee-cup" aria-hidden="true"></div>
           <h1 class="app-title">Java Chat</h1>
         </a>
         <div class="tab-buttons" role="tablist" aria-label="Java Chat Sections">
           <button type="button" id="tab-chat" class="tab" role="tab" aria-selected="true" aria-controls="tabpanel" tabindex="0">
             <span class="tab-icon">ðŸ’¬</span>
             <span class="tab-label"><span class="tab-label-long">Chat</span><span class="tab-label-short">Chat</span></span>
           </button>
           <button type="button" id="tab-guided" class="tab" role="tab" aria-selected="false" aria-controls="tabpanel" tabindex="-1">
             <span class="tab-icon">ðŸ“š</span>
             <span class="tab-label"><span class="tab-label-long">Guided Learning</span><span class="tab-label-short">Guided</span></span>
           </button>
         </div>
      </div>
       <div class="tabs-right">
         <span class="info-badge pill-with-badge">
           <span class="status-indicator"></span>
           JDK 25 Docs
           <span class="new-badge">New</span>
         </span>
         <span class="info-badge">AI-Powered Learning</span>
       </div>
    </div>

    <div id="tabpanel" class="panel" role="tabpanel" tabindex="0" aria-labelledby="tab-chat">
      <iframe id="contentFrame" class="frame" title="Content"></iframe>
      <div id="loader" class="loader-overlay" aria-hidden="true">
        <div class="loader" aria-label="Loading content">
          <div class="shimmer large pad"></div>
          <div class="shimmer medium rounded"></div>
          <div class="shimmer small rounded"></div>
          <div class="shimmer row-2 pad"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const frame = document.getElementById('contentFrame');
    const loader = document.getElementById('loader');
    const tabs = [
      { id: 'tab-chat', url: 'chat.html' },
      { id: 'tab-guided', url: 'guided.html' }
    ];

    let loaderTimeout = null;
    
    function setActiveTab(targetId) {
      tabs.forEach(({ id, url }) => {
        const el = document.getElementById(id);
        const isActive = id === targetId;
        el.setAttribute('aria-selected', String(isActive));
        el.tabIndex = isActive ? 0 : -1;
        if (isActive) {
          document.getElementById('tabpanel').setAttribute('aria-labelledby', id);
          
          // Only show loader after a small delay to prevent flash for fast loads
          if (loaderTimeout) clearTimeout(loaderTimeout);
          loaderTimeout = setTimeout(() => showLoader(true), 100);
          
          // Clear iframe first to prevent stale content flash
          frame.style.visibility = 'hidden';
          frame.src = url;
          
          // reflect in hash for deep-linking
          const hash = id === 'tab-guided' ? '#guided' : '#chat';
          if (location.hash !== hash) history.replaceState(null, '', hash);
        }
      });
    }

    // Click handlers
    tabs.forEach(({ id }) => {
      document.getElementById(id).addEventListener('click', () => setActiveTab(id));
    });

    // Keyboard navigation (Left/Right)
    document.querySelector('.tab-buttons').addEventListener('keydown', (e) => {
      const order = tabs.map(t => t.id);
      const activeIdx = order.findIndex(id => document.getElementById(id).getAttribute('aria-selected') === 'true');
      if (e.key === 'ArrowRight') {
        e.preventDefault();
        const next = order[(activeIdx + 1) % order.length];
        setActiveTab(next);
        document.getElementById(next).focus();
      } else if (e.key === 'ArrowLeft') {
        e.preventDefault();
        const prev = order[(activeIdx - 1 + order.length) % order.length];
        setActiveTab(prev);
        document.getElementById(prev).focus();
      }
    });

    // Hide loader when iframe finishes loading
    frame.addEventListener('load', () => {
      // Cancel pending loader if it hasn't shown yet
      if (loaderTimeout) {
        clearTimeout(loaderTimeout);
        loaderTimeout = null;
      }
      // Small delay to ensure content is painted
      setTimeout(() => {
        showLoader(false);
        frame.style.visibility = 'visible';
      }, 50);
    });

    // Immediately hide loader when inner page signals readiness
    window.addEventListener('message', (e) => {
      const data = e && e.data;
      if (!data || typeof data !== 'object') return;
      
      if (data.type === 'content-started' || data.type === 'content-ready' || data.type === 'dom-ready') {
        // Cancel pending loader
        if (loaderTimeout) {
          clearTimeout(loaderTimeout);
          loaderTimeout = null;
        }
        // Hide loader immediately
        showLoader(false);
        frame.style.visibility = 'visible';
      }
    });

    function showLoader(show) {
      const panel = document.getElementById('tabpanel');
      if (show) {
        loader.classList.add('show');
        panel.setAttribute('aria-busy', 'true');
      } else {
        loader.classList.remove('show');
        panel.setAttribute('aria-busy', 'false');
      }
    }

    // Initial tab selection from hash
    function initialTab() {
      const h = (location.hash || '').toLowerCase();
      if (h.includes('guided')) return 'tab-guided';
      return 'tab-chat';
    }

    // Initialize
    setActiveTab(initialTab());
  </script>
</body>
</html>
